<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css"> <!-- load bootstrap css -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">

</head>

<body ng-app = "myApp" ng-controller="myController" >

<form  name = "form"  ng-submit="submitForm()">

    <div class="form-group">
        <label >Enter the user email:</label>
        <textarea class="form-control" rows="1" name="email" placeholder = "Enter user name" ng-model = "formData.email" ></textarea>


    </div>

    <button type="submit"   class="btn btn-warning btn-lg">Search this user</button>

</form>
<div ng-show = "!isAvailable()">
    <p>{{message}}</p>


</div>
<div ng-show = "isAvailable()">
    <p>{{email}}</p>
    <p>{{timeCreated}}</p>
    <p>{{scores}}</p>

</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" ></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular-route.min.js"></script>

<script>

    var app = angular.module('myApp', []);

    console.log('Controller is ready!');
    app.controller('myController',['$scope','$http',function($scope,$http){
        console.log('Controller is ready!');
        $scope.formData = {};
        $scope.submitForm = function() {
            console.log("submit");
            var onSuccess = function (response) {
                console.log(response.data);
                console.log(response.data.success);

                $scope.formData = {};

                $scope.isAvailable = function () {
                    if (response.data.success==false) {
                        $scope.message = response.data.message;
                        console.log(response.data.message);
                        return false;
                    }
                    else {

                        $scope.email = response.data.user.local.email;
                        $scope.timeCreated = response.data.user.local.timeCreated;
                        $scope.scores = response.data.scores;


                        return true;
                    }
                }


            }
            var onFailure = function(response){

            }
            $http.post('/search',$scope.formData).then(onSuccess,onFailure);
        }








    }]);




</script>
</body>
</html>